import{r as e,c as t,j as n,R as r,a as o,F as i,u as a,b as s,_ as c}from"./vendor-Cu1oZwtV.js";import{R as l,O as u,P as f,S as d,a as p,N as v,A as h,L as m,b as g,U as b,W as y,C as w,B as _,c as P,V as C,d as j,e as E,f as x,T as M,g as S,p as k,h as O}from"./vendor-three-C8xAa_la.js";var T={exports:{}},I={};
/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
!function(e){function t(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<o(i,t)))break e;e[r]=t,e[n]=i,n=r}}function n(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,a=i>>>1;r<a;){var s=2*(r+1)-1,c=e[s],l=s+1,u=e[l];if(0>o(c,n))l<i&&0>o(u,c)?(e[r]=u,e[l]=n,r=l):(e[r]=c,e[s]=n,r=s);else{if(!(l<i&&0>o(u,n)))break e;e[r]=u,e[l]=n,r=l}}}return t}function o(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var i=performance;e.unstable_now=function(){return i.now()}}else{var a=Date,s=a.now();e.unstable_now=function(){return a.now()-s}}var c=[],l=[],u=1,f=null,d=3,p=!1,v=!1,h=!1,m="function"==typeof setTimeout?setTimeout:null,g="function"==typeof clearTimeout?clearTimeout:null,b="undefined"!=typeof setImmediate?setImmediate:null;function y(e){for(var o=n(l);null!==o;){if(null===o.callback)r(l);else{if(!(o.startTime<=e))break;r(l),o.sortIndex=o.expirationTime,t(c,o)}o=n(l)}}function w(e){if(h=!1,y(e),!v)if(null!==n(c))v=!0,I(_);else{var t=n(l);null!==t&&L(w,t.startTime-e)}}function _(t,o){v=!1,h&&(h=!1,g(E),E=-1),p=!0;var i=d;try{for(y(o),f=n(c);null!==f&&(!(f.expirationTime>o)||t&&!S());){var a=f.callback;if("function"==typeof a){f.callback=null,d=f.priorityLevel;var s=a(f.expirationTime<=o);o=e.unstable_now(),"function"==typeof s?f.callback=s:f===n(c)&&r(c),y(o)}else r(c);f=n(c)}if(null!==f)var u=!0;else{var m=n(l);null!==m&&L(w,m.startTime-o),u=!1}return u}finally{f=null,d=i,p=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var P,C=!1,j=null,E=-1,x=5,M=-1;function S(){return!(e.unstable_now()-M<x)}function k(){if(null!==j){var t=e.unstable_now();M=t;var n=!0;try{n=j(!0,t)}finally{n?P():(C=!1,j=null)}}else C=!1}if("function"==typeof b)P=function(){b(k)};else if("undefined"!=typeof MessageChannel){var O=new MessageChannel,T=O.port2;O.port1.onmessage=k,P=function(){T.postMessage(null)}}else P=function(){m(k,0)};function I(e){j=e,C||(C=!0,P())}function L(t,n){E=m(function(){t(e.unstable_now())},n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_continueExecution=function(){v||p||(v=!0,I(_))},e.unstable_forceFrameRate=function(e){0>e||125<e||(x=0<e?Math.floor(1e3/e):5)},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(e){switch(d){case 1:case 2:case 3:var t=3;break;default:t=d}var n=d;d=t;try{return e()}finally{d=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=d;d=e;try{return t()}finally{d=n}},e.unstable_scheduleCallback=function(r,o,i){var a=e.unstable_now();switch("object"==typeof i&&null!==i?i="number"==typeof(i=i.delay)&&0<i?a+i:a:i=a,r){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return r={id:u++,callback:o,priorityLevel:r,startTime:i,expirationTime:s=i+s,sortIndex:-1},i>a?(r.sortIndex=i,t(l,r),null===n(c)&&r===n(l)&&(h?(g(E),E=-1):h=!0,L(w,i-a))):(r.sortIndex=s,t(c,r),v||p||(v=!0,I(_))),r},e.unstable_shouldYield=S,e.unstable_wrapCallback=function(e){var t=d;return function(){var n=d;d=t;try{return e.apply(this,arguments)}finally{d=n}}}}(I),T.exports=I;var L=T.exports;const z={};var A,R;const D=e=>"colorSpace"in e||"outputColorSpace"in e,H=()=>{var e;return null!=(e=z.ColorManagement)?e:null},F=e=>e&&e.isOrthographicCamera,q="undefined"!=typeof window&&(null!=(A=window.document)&&A.createElement||"ReactNative"===(null==(R=window.navigator)?void 0:R.product))?e.useLayoutEffect:e.useEffect;function B(t){const n=e.useRef(t);return q(()=>{n.current=t},[t]),n}function U({set:e}){return q(()=>(e(new Promise(()=>null)),()=>e(!1)),[e]),null}class N extends e.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}N.getDerivedStateFromError=()=>({error:!0});const W="__default",Y=new Map,X=e=>e&&!!e.memoized&&!!e.changes;function V(e){var t;const n="undefined"!=typeof window?null!=(t=window.devicePixelRatio)?t:2:1;return Array.isArray(e)?Math.min(Math.max(e[0],n),e[1]):e}const $=e=>{var t;return null==(t=e.__r3f)?void 0:t.root.getState()};function G(e){let t=e.__r3f.root;for(;t.getState().previousRoot;)t=t.getState().previousRoot;return t}const J={obj:e=>e===Object(e)&&!J.arr(e)&&"function"!=typeof e,fun:e=>"function"==typeof e,str:e=>"string"==typeof e,num:e=>"number"==typeof e,boo:e=>"boolean"==typeof e,und:e=>void 0===e,arr:e=>Array.isArray(e),equ(e,t,{arrays:n="shallow",objects:r="reference",strict:o=!0}={}){if(typeof e!=typeof t||!!e!=!!t)return!1;if(J.str(e)||J.num(e)||J.boo(e))return e===t;const i=J.obj(e);if(i&&"reference"===r)return e===t;const a=J.arr(e);if(a&&"reference"===n)return e===t;if((a||i)&&e===t)return!0;let s;for(s in e)if(!(s in t))return!1;if(i&&"shallow"===n&&"shallow"===r){for(s in o?t:e)if(!J.equ(e[s],t[s],{strict:o,objects:"reference"}))return!1}else for(s in o?t:e)if(e[s]!==t[s])return!1;if(J.und(s)){if(a&&0===e.length&&0===t.length)return!0;if(i&&0===Object.keys(e).length&&0===Object.keys(t).length)return!0;if(e!==t)return!1}return!0}};function K(e,t){return e.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...t},e}function Q(e,t){let n=e;if(t.includes("-")){const r=t.split("-"),o=r.pop();return n=r.reduce((e,t)=>e[t],e),{target:n,key:o}}return{target:n,key:t}}const Z=/-\d+$/;function ee(e,t,n){if(J.str(n)){if(Z.test(n)){const t=n.replace(Z,""),{target:r,key:o}=Q(e,t);Array.isArray(r[o])||(r[o]=[])}const{target:r,key:o}=Q(e,n);t.__r3f.previousAttach=r[o],r[o]=t}else t.__r3f.previousAttach=n(e,t)}function te(e,t,n){var r,o;if(J.str(n)){const{target:r,key:o}=Q(e,n),i=t.__r3f.previousAttach;void 0===i?delete r[o]:r[o]=i}else null==(r=t.__r3f)||null==r.previousAttach||r.previousAttach(e,t);null==(o=t.__r3f)||delete o.previousAttach}function ne(e,{children:t,key:n,ref:r,...o},{children:i,key:a,ref:s,...c}={},l=!1){const u=e.__r3f,f=Object.entries(o),d=[];if(l){const e=Object.keys(c);for(let t=0;t<e.length;t++)o.hasOwnProperty(e[t])||f.unshift([e[t],W+"remove"])}f.forEach(([t,n])=>{var r;if(null!=(r=e.__r3f)&&r.primitive&&"object"===t)return;if(J.equ(n,c[t]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(t))return d.push([t,n,!0,[]]);let i=[];t.includes("-")&&(i=t.split("-")),d.push([t,n,!1,i]);for(const e in o){const n=o[e];e.startsWith(`${t}-`)&&d.push([e,n,!1,e.split("-")])}});const p={...o};return null!=u&&u.memoizedProps&&null!=u&&u.memoizedProps.args&&(p.args=u.memoizedProps.args),null!=u&&u.memoizedProps&&null!=u&&u.memoizedProps.attach&&(p.attach=u.memoizedProps.attach),{memoized:p,changes:d}}const re="undefined"!=typeof process&&!1;function oe(e,t){var n;const r=e.__r3f,o=null==r?void 0:r.root,i=null==o||null==o.getState?void 0:o.getState(),{memoized:a,changes:s}=X(t)?t:ne(e,t),c=null==r?void 0:r.eventCount;e.__r3f&&(e.__r3f.memoizedProps=a);for(let f=0;f<s.length;f++){let[t,n,o,a]=s[f];if(D(e)){const e=3001,r="srgb",o="srgb-linear";"encoding"===t?(t="colorSpace",n=n===e?r:o):"outputEncoding"===t&&(t="outputColorSpace",n=n===e?r:o)}let c=e,d=c[t];if(a.length&&(d=a.reduce((e,t)=>e[t],e),!d||!d.set)){const[n,...r]=a.reverse();c=r.reverse().reduce((e,t)=>e[t],e),t=n}if(n===W+"remove")if(c.constructor){let e=Y.get(c.constructor);e||(e=new c.constructor,Y.set(c.constructor,e)),n=e[t]}else n=0;if(o&&r)n?r.handlers[t]=n:delete r.handlers[t],r.eventCount=Object.keys(r.handlers).length;else if(d&&d.set&&(d.copy||d instanceof m)){if(Array.isArray(n))d.fromArray?d.fromArray(n):d.set(...n);else if(d.copy&&n&&n.constructor&&(re?d.constructor.name===n.constructor.name:d.constructor===n.constructor))d.copy(n);else if(void 0!==n){var l;const e=null==(l=d)?void 0:l.isColor;!e&&d.setScalar?d.setScalar(n):d instanceof m&&n instanceof m?d.mask=n.mask:d.set(n),!H()&&i&&!i.linear&&e&&d.convertSRGBToLinear()}}else{var u;if(c[t]=n,null!=(u=c[t])&&u.isTexture&&c[t].format===g&&c[t].type===b&&i){const e=c[t];D(e)&&D(i.gl)?e.colorSpace=i.gl.outputColorSpace:e.encoding=i.gl.outputEncoding}}ie(e)}if(r&&r.parent&&e.raycast&&c!==r.eventCount){const t=G(e).getState().internal,n=t.interaction.indexOf(e);n>-1&&t.interaction.splice(n,1),r.eventCount&&t.interaction.push(e)}return!(1===s.length&&"onUpdate"===s[0][0])&&s.length&&null!=(n=e.__r3f)&&n.parent&&ae(e),e}function ie(e){var t,n;const r=null==(t=e.__r3f)||null==(n=t.root)||null==n.getState?void 0:n.getState();r&&0===r.internal.frames&&r.invalidate()}function ae(e){null==e.onUpdate||e.onUpdate(e)}function se(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function ce(e,t,n,r){const o=n.get(t);o&&(n.delete(t),0===n.size&&(e.delete(r),o.target.releasePointerCapture(r)))}function le(e){function t(e){return e.filter(e=>["Move","Over","Enter","Out","Leave"].some(t=>{var n;return null==(n=e.__r3f)?void 0:n.handlers["onPointer"+t]}))}function n(t){const{internal:n}=e.getState();for(const e of n.hovered.values())if(!t.length||!t.find(t=>t.object===e.object&&t.index===e.index&&t.instanceId===e.instanceId)){const r=e.eventObject.__r3f,o=null==r?void 0:r.handlers;if(n.hovered.delete(se(e)),null!=r&&r.eventCount){const n={...e,intersections:t};null==o.onPointerOut||o.onPointerOut(n),null==o.onPointerLeave||o.onPointerLeave(n)}}}function r(e,t){for(let n=0;n<t.length;n++){const r=t[n].__r3f;null==r||null==r.handlers.onPointerMissed||r.handlers.onPointerMissed(e)}}return{handlePointer:function(o){switch(o){case"onPointerLeave":case"onPointerCancel":return()=>n([]);case"onLostPointerCapture":return t=>{const{internal:r}=e.getState();"pointerId"in t&&r.capturedMap.has(t.pointerId)&&requestAnimationFrame(()=>{r.capturedMap.has(t.pointerId)&&(r.capturedMap.delete(t.pointerId),n([]))})}}return function(i){const{onPointerMissed:a,internal:s}=e.getState();s.lastEvent.current=i;const c="onPointerMove"===o,l="onClick"===o||"onContextMenu"===o||"onDoubleClick"===o,u=function(t,n){const r=e.getState(),o=new Set,i=[],a=n?n(r.internal.interaction):r.internal.interaction;for(let e=0;e<a.length;e++){const t=$(a[e]);t&&(t.raycaster.camera=void 0)}r.previousRoot||null==r.events.compute||r.events.compute(t,r);let s=a.flatMap(function(e){const n=$(e);return n&&n.events.enabled&&null!==n.raycaster.camera?(void 0===n.raycaster.camera&&(null==n.events.compute||n.events.compute(t,n,null==(r=n.previousRoot)?void 0:r.getState()),void 0===n.raycaster.camera&&(n.raycaster.camera=null)),n.raycaster.camera?n.raycaster.intersectObject(e,!0):[]):[];var r}).sort((e,t)=>{const n=$(e.object),r=$(t.object);return n&&r&&r.events.priority-n.events.priority||e.distance-t.distance}).filter(e=>{const t=se(e);return!o.has(t)&&(o.add(t),!0)});r.events.filter&&(s=r.events.filter(s,r));for(const e of s){let t=e.object;for(;t;){var c;null!=(c=t.__r3f)&&c.eventCount&&i.push({...e,eventObject:t}),t=t.parent}}if("pointerId"in t&&r.internal.capturedMap.has(t.pointerId))for(let e of r.internal.capturedMap.get(t.pointerId).values())o.has(se(e.intersection))||i.push(e.intersection);return i}(i,c?t:void 0),f=l?function(t){const{internal:n}=e.getState(),r=t.offsetX-n.initialClick[0],o=t.offsetY-n.initialClick[1];return Math.round(Math.sqrt(r*r+o*o))}(i):0;"onPointerDown"===o&&(s.initialClick=[i.offsetX,i.offsetY],s.initialHits=u.map(e=>e.eventObject)),l&&!u.length&&f<=2&&(r(i,s.interaction),a&&a(i)),c&&n(u),function(t,r,o,i){const a=e.getState();if(t.length){const e={stopped:!1};for(const s of t){const c=$(s.object)||a,{raycaster:l,pointer:u,camera:f,internal:d}=c,p=new j(u.x,u.y,0).unproject(f),v=e=>{var t,n;return null!=(t=null==(n=d.capturedMap.get(e))?void 0:n.has(s.eventObject))&&t},h=e=>{const t={intersection:s,target:r.target};d.capturedMap.has(e)?d.capturedMap.get(e).set(s.eventObject,t):d.capturedMap.set(e,new Map([[s.eventObject,t]])),r.target.setPointerCapture(e)},m=e=>{const t=d.capturedMap.get(e);t&&ce(d.capturedMap,s.eventObject,t,e)};let g={};for(let e in r){let t=r[e];"function"!=typeof t&&(g[e]=t)}let b={...s,...g,pointer:u,intersections:t,stopped:e.stopped,delta:o,unprojectedPoint:p,ray:l.ray,camera:f,stopPropagation(){const o="pointerId"in r&&d.capturedMap.get(r.pointerId);(!o||o.has(s.eventObject))&&(b.stopped=e.stopped=!0,d.hovered.size&&Array.from(d.hovered.values()).find(e=>e.eventObject===s.eventObject))&&n([...t.slice(0,t.indexOf(s)),s])},target:{hasPointerCapture:v,setPointerCapture:h,releasePointerCapture:m},currentTarget:{hasPointerCapture:v,setPointerCapture:h,releasePointerCapture:m},nativeEvent:r};if(i(b),!0===e.stopped)break}}}(u,i,f,function(e){const t=e.eventObject,n=t.__r3f,a=null==n?void 0:n.handlers;if(null!=n&&n.eventCount)if(c){if(a.onPointerOver||a.onPointerEnter||a.onPointerOut||a.onPointerLeave){const t=se(e),n=s.hovered.get(t);n?n.stopped&&e.stopPropagation():(s.hovered.set(t,e),null==a.onPointerOver||a.onPointerOver(e),null==a.onPointerEnter||a.onPointerEnter(e))}null==a.onPointerMove||a.onPointerMove(e)}else{const n=a[o];n?l&&!s.initialHits.includes(t)||(r(i,s.interaction.filter(e=>!s.initialHits.includes(e))),n(e)):l&&s.initialHits.includes(t)&&r(i,s.interaction.filter(e=>!s.initialHits.includes(e)))}})}}}}const ue=e=>!(null==e||!e.render),fe=e.createContext(null),de=(t,n)=>{const r=o((r,o)=>{const i=new j,a=new j,s=new j;function c(e=o().camera,t=a,n=o().size){const{width:r,height:c,top:l,left:u}=n,f=r/c;t.isVector3?s.copy(t):s.set(...t);const d=e.getWorldPosition(i).distanceTo(s);if(F(e))return{width:r/e.zoom,height:c/e.zoom,top:l,left:u,factor:1,distance:d,aspect:f};{const t=e.fov*Math.PI/180,n=2*Math.tan(t/2)*d,o=n*(r/c);return{width:o,height:n,top:l,left:u,factor:r/o,distance:d,aspect:f}}}let l;const u=e=>r(t=>({performance:{...t.performance,current:e}})),f=new E;return{set:r,get:o,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(e=1)=>t(o(),e),advance:(e,t)=>n(e,t,o()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new x,pointer:f,mouse:f,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const e=o();l&&clearTimeout(l),e.performance.current!==e.performance.min&&u(e.performance.min),l=setTimeout(()=>u(o().performance.max),e.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:c},setEvents:e=>r(t=>({...t,events:{...t.events,...e}})),setSize:(e,t,n,i,s)=>{const l=o().camera,u={width:e,height:t,top:i||0,left:s||0,updateStyle:n};r(e=>({size:u,viewport:{...e.viewport,...c(l,a,u)}}))},setDpr:e=>r(t=>{const n=V(e);return{viewport:{...t.viewport,dpr:n,initialDpr:t.viewport.initialDpr||n}}}),setFrameloop:(e="always")=>{const t=o().clock;t.stop(),t.elapsedTime=0,"never"!==e&&(t.start(),t.elapsedTime=0),r(()=>({frameloop:e}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:e.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(e,t,n)=>{const r=o().internal;return r.priority=r.priority+(t>0?1:0),r.subscribers.push({ref:e,priority:t,store:n}),r.subscribers=r.subscribers.sort((e,t)=>e.priority-t.priority),()=>{const n=o().internal;null!=n&&n.subscribers&&(n.priority=n.priority-(t>0?1:0),n.subscribers=n.subscribers.filter(t=>t.ref!==e))}}}}}),i=r.getState();let a=i.size,s=i.viewport.dpr,c=i.camera;return r.subscribe(()=>{const{camera:e,size:t,viewport:n,gl:o,set:i}=r.getState();if(t.width!==a.width||t.height!==a.height||n.dpr!==s){var l;a=t,s=n.dpr,function(e,t){e.manual||(F(e)?(e.left=t.width/-2,e.right=t.width/2,e.top=t.height/2,e.bottom=t.height/-2):e.aspect=t.width/t.height,e.updateProjectionMatrix(),e.updateMatrixWorld())}(e,t),o.setPixelRatio(n.dpr);const r=null!=(l=t.updateStyle)?l:"undefined"!=typeof HTMLCanvasElement&&o.domElement instanceof HTMLCanvasElement;o.setSize(t.width,t.height,r)}e!==c&&(c=e,i(t=>({viewport:{...t.viewport,...t.viewport.getCurrentViewport(e)}})))}),r.subscribe(e=>t(e)),r};let pe,ve,he,me=new Set,ge=new Set,be=new Set;function ye(e,t){if(e.size)for(const{callback:n}of e.values())n(t)}function we(e,t){switch(e){case"before":return ye(me,t);case"after":return ye(ge,t);case"tail":return ye(be,t)}}function _e(e,t,n){let r=t.clock.getDelta();for("never"===t.frameloop&&"number"==typeof e&&(r=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),ve=t.internal.subscribers,pe=0;pe<ve.length;pe++)he=ve[pe],he.ref.current(he.store.getState(),r,n);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),"always"===t.frameloop?1:t.internal.frames}function Pe(){const t=e.useContext(fe);if(!t)throw new Error("R3F: Hooks can only be used within the Canvas component!");return t}function Ce(e=e=>e,t){return Pe()(e,t)}function je(e,t=0){const n=Pe(),r=n.getState().internal.subscribe,o=B(e);return q(()=>r(o,t,n),[t,r,n]),null}const Ee=new Map,{invalidate:xe,advance:Me}=function(e){let t,n,r,o=!1,i=!1;function a(s){n=requestAnimationFrame(a),o=!0,t=0,we("before",s),i=!0;for(const n of e.values()){var c;r=n.store.getState(),!r.internal.active||!("always"===r.frameloop||r.internal.frames>0)||null!=(c=r.gl.xr)&&c.isPresenting||(t+=_e(s,r))}if(i=!1,we("after",s),0===t)return we("tail",s),o=!1,cancelAnimationFrame(n)}return{loop:a,invalidate:function t(n,r=1){var s;if(!n)return e.forEach(e=>t(e.store.getState(),r));null!=(s=n.gl.xr)&&s.isPresenting||!n.internal.active||"never"===n.frameloop||(n.internal.frames=r>1?Math.min(60,n.internal.frames+r):i?2:1,o||(o=!0,requestAnimationFrame(a)))},advance:function(t,n=!0,r,o){if(n&&we("before",t),r)_e(t,r,o);else for(const i of e.values())_e(t,i.store.getState());n&&we("after",t)}}}(Ee),{reconciler:Se,applyProps:ke}=function(e,n){function o(e,{args:t=[],attach:n,...r},o){let i,a=`${e[0].toUpperCase()}${e.slice(1)}`;if("primitive"===e){if(void 0===r.object)throw new Error("R3F: Primitives without 'object' are invalid!");i=K(r.object,{type:e,root:o,attach:n,primitive:!0})}else{const r=z[a];if(!r)throw new Error(`R3F: ${a} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(t))throw new Error("R3F: The args prop must be an array!");i=K(new r(...t),{type:e,root:o,attach:n,memoizedProps:{args:t}})}return void 0===i.__r3f.attach&&(i.isBufferGeometry?i.__r3f.attach="geometry":i.isMaterial&&(i.__r3f.attach="material")),"inject"!==a&&oe(i,r),i}function i(e,t){let n=!1;var r,o;t&&(null!=(r=t.__r3f)&&r.attach?ee(e,t,t.__r3f.attach):t.isObject3D&&e.isObject3D&&(e.add(t),n=!0),n||null==(o=e.__r3f)||o.objects.push(t),t.__r3f||K(t,{}),t.__r3f.parent=e,ae(t),ie(t))}function a(e,t,n){let r=!1;if(t){var o,i;if(null!=(o=t.__r3f)&&o.attach)ee(e,t,t.__r3f.attach);else if(t.isObject3D&&e.isObject3D){t.parent=e,t.dispatchEvent({type:"added"}),e.dispatchEvent({type:"childadded",child:t});const o=e.children.filter(e=>e!==t),i=o.indexOf(n);e.children=[...o.slice(0,i),t,...o.slice(i)],r=!0}r||null==(i=e.__r3f)||i.objects.push(t),t.__r3f||K(t,{}),t.__r3f.parent=e,ae(t),ie(t)}}function s(e,t,n=!1){e&&[...e].forEach(e=>c(t,e,n))}function c(e,t,n){if(t){var r,o,i;if(t.__r3f&&(t.__r3f.parent=null),null!=(r=e.__r3f)&&r.objects&&(e.__r3f.objects=e.__r3f.objects.filter(e=>e!==t)),null!=(o=t.__r3f)&&o.attach)te(e,t,t.__r3f.attach);else if(t.isObject3D&&e.isObject3D){var a;e.remove(t),null!=(a=t.__r3f)&&a.root&&function(e,t){const{internal:n}=e.getState();n.interaction=n.interaction.filter(e=>e!==t),n.initialHits=n.initialHits.filter(e=>e!==t),n.hovered.forEach((e,r)=>{e.eventObject!==t&&e.object!==t||n.hovered.delete(r)}),n.capturedMap.forEach((e,r)=>{ce(n.capturedMap,t,e,r)})}(G(t),t)}const l=null==(i=t.__r3f)?void 0:i.primitive,u=!l&&(void 0===n?null!==t.dispose:n);var c;if(!l)s(null==(c=t.__r3f)?void 0:c.objects,t,u),s(t.children,t,u);if(delete t.__r3f,u&&t.dispose&&"Scene"!==t.type){const e=()=>{try{t.dispose()}catch(e){}};"undefined"==typeof IS_REACT_ACT_ENVIRONMENT?L.unstable_scheduleCallback(L.unstable_IdlePriority,e):e()}ie(e)}}const l=()=>{};return{reconciler:r({createInstance:o,removeChild:c,appendChild:i,appendInitialChild:i,insertBefore:a,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(e,t)=>{if(!t)return;const n=e.getState().scene;n.__r3f&&(n.__r3f.root=e,i(n,t))},removeChildFromContainer:(e,t)=>{t&&c(e.getState().scene,t)},insertInContainerBefore:(e,t,n)=>{if(!t||!n)return;const r=e.getState().scene;r.__r3f&&a(r,t,n)},getRootHostContext:()=>null,getChildHostContext:e=>e,finalizeInitialChildren(e){var t;const n=null!=(t=null==e?void 0:e.__r3f)?t:{};return Boolean(n.handlers)},prepareUpdate(e,t,n,r){var o;if((null!=(o=null==e?void 0:e.__r3f)?o:{}).primitive&&r.object&&r.object!==e)return[!0];{const{args:t=[],children:o,...i}=r,{args:a=[],children:s,...c}=n;if(!Array.isArray(t))throw new Error("R3F: the args prop must be an array!");if(t.some((e,t)=>e!==a[t]))return[!0];const l=ne(e,i,c,!0);return l.changes.length?[!1,l]:null}},commitUpdate(e,[t,n],r,a,s,l){t?function(e,t,n,r){var a;const s=null==(a=e.__r3f)?void 0:a.parent;if(!s)return;const l=o(t,n,e.__r3f.root);if(e.children){for(const t of e.children)t.__r3f&&i(l,t);e.children=e.children.filter(e=>!e.__r3f)}e.__r3f.objects.forEach(e=>i(l,e)),e.__r3f.objects=[],e.__r3f.autoRemovedBeforeAppend||c(s,e),l.parent&&(l.__r3f.autoRemovedBeforeAppend=!0),i(s,l),l.raycast&&l.__r3f.eventCount&&G(l).getState().internal.interaction.push(l);[r,r.alternate].forEach(e=>{null!==e&&(e.stateNode=l,e.ref&&("function"==typeof e.ref?e.ref(l):e.ref.current=l))})}(e,r,s,l):oe(e,n)},commitMount(e,t,n,r){var o;const i=null!=(o=e.__r3f)?o:{};e.raycast&&i.handlers&&i.eventCount&&G(e).getState().internal.interaction.push(e)},getPublicInstance:e=>e,prepareForCommit:()=>null,preparePortalMount:e=>K(e.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(e){var t;const{attach:n,parent:r}=null!=(t=e.__r3f)?t:{};n&&r&&te(r,e,n),e.isObject3D&&(e.visible=!1),ie(e)},unhideInstance(e,t){var n;const{attach:r,parent:o}=null!=(n=e.__r3f)?n:{};r&&o&&ee(o,e,r),(e.isObject3D&&null==t.visible||t.visible)&&(e.visible=!0),ie(e)},createTextInstance:l,hideTextInstance:l,unhideTextInstance:l,getCurrentEventPriority:()=>n?n():t.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:"undefined"!=typeof performance&&J.fun(performance.now)?performance.now:J.fun(Date.now)?Date.now:()=>0,scheduleTimeout:J.fun(setTimeout)?setTimeout:void 0,cancelTimeout:J.fun(clearTimeout)?clearTimeout:void 0}),applyProps:oe}}(0,function(){var e;const n="undefined"!=typeof self&&self||"undefined"!=typeof window&&window;if(!n)return t.DefaultEventPriority;switch(null==(e=n.event)?void 0:e.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return t.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return t.ContinuousEventPriority;default:return t.DefaultEventPriority}}),Oe={objects:"shallow",strict:!1},Te=(e,t)=>{const n="function"==typeof e?e(t):e;return ue(n)?n:new y({powerPreference:"high-performance",canvas:t,antialias:!0,alpha:!0,...e})};function Ie(e){const r=Ee.get(e),o=null==r?void 0:r.fiber,i=null==r?void 0:r.store,a="function"==typeof reportError?reportError:console.error,s=i||de(xe,Me),c=o||Se.createContainer(s,t.ConcurrentRoot,null,!1,null,"",a,null);let m;r||Ee.set(e,{fiber:c,store:s});let g,b=!1;return{configure(t={}){let{gl:n,size:r,scene:o,events:i,onCreated:a,shadows:c=!1,linear:y=!1,flat:j=!1,legacy:E=!1,orthographic:x=!1,frameloop:M="always",dpr:S=[1,2],performance:k,raycaster:O,camera:T,onPointerMissed:I}=t,L=s.getState(),z=L.gl;L.gl||L.set({gl:z=Te(n,e)});let A=L.raycaster;A||L.set({raycaster:A=new l});const{params:R,...D}=O||{};if(J.equ(D,A,Oe)||ke(A,{...D}),J.equ(R,A.params,Oe)||ke(A,{params:{...A.params,...R}}),!L.camera||L.camera===g&&!J.equ(g,T,Oe)){g=T;const e=T instanceof w,t=e?T:x?new u(0,0,0,0,.1,1e3):new f(75,0,.1,1e3);e||(t.position.z=5,T&&(ke(t,T),("aspect"in T||"left"in T||"right"in T||"bottom"in T||"top"in T)&&(t.manual=!0,t.updateProjectionMatrix())),L.camera||null!=T&&T.rotation||t.lookAt(0,0,0)),L.set({camera:t}),A.camera=t}if(!L.scene){let e;null!=o&&o.isScene?e=o:(e=new d,o&&ke(e,o)),L.set({scene:K(e)})}if(!L.xr){var F;const e=(e,t)=>{const n=s.getState();"never"!==n.frameloop&&Me(e,!0,n,t)},t=()=>{const t=s.getState();t.gl.xr.enabled=t.gl.xr.isPresenting,t.gl.xr.setAnimationLoop(t.gl.xr.isPresenting?e:null),t.gl.xr.isPresenting||xe(t)},n={connect(){const e=s.getState().gl;e.xr.addEventListener("sessionstart",t),e.xr.addEventListener("sessionend",t)},disconnect(){const e=s.getState().gl;e.xr.removeEventListener("sessionstart",t),e.xr.removeEventListener("sessionend",t)}};"function"==typeof(null==(F=z.xr)?void 0:F.addEventListener)&&n.connect(),L.set({xr:n})}if(z.shadowMap){const e=z.shadowMap.enabled,t=z.shadowMap.type;if(z.shadowMap.enabled=!!c,J.boo(c))z.shadowMap.type=p;else if(J.str(c)){var q;const e={basic:_,percentage:P,soft:p,variance:C};z.shadowMap.type=null!=(q=e[c])?q:p}else J.obj(c)&&Object.assign(z.shadowMap,c);e===z.shadowMap.enabled&&t===z.shadowMap.type||(z.shadowMap.needsUpdate=!0)}const B=H();if(B&&("enabled"in B?B.enabled=!E:"legacyMode"in B&&(B.legacyMode=E)),!b){ke(z,{outputEncoding:y?3e3:3001,toneMapping:j?v:h})}L.legacy!==E&&L.set(()=>({legacy:E})),L.linear!==y&&L.set(()=>({linear:y})),L.flat!==j&&L.set(()=>({flat:j})),!n||J.fun(n)||ue(n)||J.equ(n,z,Oe)||ke(z,n),i&&!L.events.handlers&&L.set({events:i(s)});const U=function(e,t){const n="undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement;if(t){const{width:e,height:r,top:o,left:i,updateStyle:a=n}=t;return{width:e,height:r,top:o,left:i,updateStyle:a}}if("undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement&&e.parentElement){const{width:t,height:r,top:o,left:i}=e.parentElement.getBoundingClientRect();return{width:t,height:r,top:o,left:i,updateStyle:n}}return"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas?{width:e.width,height:e.height,top:0,left:0,updateStyle:n}:{width:0,height:0,top:0,left:0}}(e,r);return J.equ(U,L.size,Oe)||L.setSize(U.width,U.height,U.updateStyle,U.top,U.left),S&&L.viewport.dpr!==V(S)&&L.setDpr(S),L.frameloop!==M&&L.setFrameloop(M),L.onPointerMissed||L.set({onPointerMissed:I}),k&&!J.equ(k,L.performance,Oe)&&L.set(e=>({performance:{...e.performance,...k}})),m=a,b=!0,this},render(t){return b||this.configure(),Se.updateContainer(n.jsx(Le,{store:s,children:t,onCreated:m,rootElement:e}),c,null,()=>{}),s},unmount(){ze(e)}}}function Le({store:e,children:t,onCreated:r,rootElement:o}){return q(()=>{const t=e.getState();t.set(e=>({internal:{...e.internal,active:!0}})),r&&r(t),e.getState().events.connected||null==t.events.connect||t.events.connect(o)},[]),n.jsx(fe.Provider,{value:e,children:t})}function ze(e,t){const n=Ee.get(e),r=null==n?void 0:n.fiber;if(r){const t=null==n?void 0:n.store.getState();t&&(t.internal.active=!1),Se.updateContainer(null,r,null,()=>{t&&setTimeout(()=>{try{var n,r,o,i;null==t.events.disconnect||t.events.disconnect(),null==(n=t.gl)||null==(r=n.renderLists)||null==r.dispose||r.dispose(),null==(o=t.gl)||null==o.forceContextLoss||o.forceContextLoss(),null!=(i=t.gl)&&i.xr&&t.xr.disconnect(),function(e){e.dispose&&"Scene"!==e.type&&e.dispose();for(const t in e)null==t.dispose||t.dispose(),delete e[t]}(t),Ee.delete(e)}catch(a){}},500)})}}Se.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:e.version});const Ae={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function Re(e){const{handlePointer:t}=le(e);return{priority:1,enabled:!0,compute(e,t,n){t.pointer.set(e.offsetX/t.size.width*2-1,-e.offsetY/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,t.camera)},connected:void 0,handlers:Object.keys(Ae).reduce((e,n)=>({...e,[n]:t(n)}),{}),update:()=>{var t;const{events:n,internal:r}=e.getState();null!=(t=r.lastEvent)&&t.current&&n.handlers&&n.handlers.onPointerMove(r.lastEvent.current)},connect:t=>{var n;const{set:r,events:o}=e.getState();null==o.disconnect||o.disconnect(),r(e=>({events:{...e.events,connected:t}})),Object.entries(null!=(n=o.handlers)?n:[]).forEach(([e,n])=>{const[r,o]=Ae[e];t.addEventListener(r,n,{passive:o})})},disconnect:()=>{const{set:t,events:n}=e.getState();var r;n.connected&&(Object.entries(null!=(r=n.handlers)?r:[]).forEach(([e,t])=>{if(n&&n.connected instanceof HTMLElement){const[r]=Ae[e];n.connected.removeEventListener(r,t)}}),t(e=>({events:{...e.events,connected:void 0}})))}}}const De=e.forwardRef(function({children:t,fallback:r,resize:o,style:i,gl:c,events:l=Re,eventSource:u,eventPrefix:f,shadows:d,linear:p,flat:v,legacy:h,orthographic:m,frameloop:g,dpr:b,performance:y,raycaster:w,camera:_,scene:P,onPointerMissed:C,onCreated:j,...E},x){e.useMemo(()=>{return e=M,void Object.assign(z,e);var e},[]);const S=a(),[k,O]=s({scroll:!0,debounce:{scroll:50,resize:0},...o}),T=e.useRef(null),I=e.useRef(null);e.useImperativeHandle(x,()=>T.current);const L=B(C),[A,R]=e.useState(!1),[D,H]=e.useState(!1);if(A)throw A;if(D)throw D;const F=e.useRef(null);q(()=>{const r=T.current;O.width>0&&O.height>0&&r&&(F.current||(F.current=Ie(r)),F.current.configure({gl:c,events:l,shadows:d,linear:p,flat:v,legacy:h,orthographic:m,frameloop:g,dpr:b,performance:y,raycaster:w,camera:_,scene:P,size:O,onPointerMissed:(...e)=>null==L.current?void 0:L.current(...e),onCreated:e=>{var t;null==e.events.connect||e.events.connect(u?(t=u)&&t.hasOwnProperty("current")?u.current:u:I.current),f&&e.setEvents({compute:(e,t)=>{const n=e[f+"X"],r=e[f+"Y"];t.pointer.set(n/t.size.width*2-1,-r/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,t.camera)}}),null==j||j(e)}}),F.current.render(n.jsx(S,{children:n.jsx(N,{set:H,children:n.jsx(e.Suspense,{fallback:n.jsx(U,{set:R}),children:null!=t?t:null})})})))}),e.useEffect(()=>{const e=T.current;if(e)return()=>ze(e)},[]);const W=u?"none":"auto";return n.jsx("div",{ref:I,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:W,...i},...E,children:n.jsx("div",{ref:k,style:{width:"100%",height:"100%"},children:n.jsx("canvas",{ref:T,style:{display:"block"},children:r})})})}),He=e.forwardRef(function(e,t){return n.jsx(i,{children:n.jsx(De,{...e,ref:t})})});function Fe(e,t,n=(e,t)=>e===t){if(e===t)return!0;if(!e||!t)return!1;const r=e.length;if(t.length!==r)return!1;for(let o=0;o<r;o++)if(!n(e[o],t[o]))return!1;return!0}const qe=[];const Be=(e,t,n)=>function(e,t,n=!1,r={}){for(const i of qe)if(Fe(t,i.keys,i.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(i,"error"))throw i.error;if(Object.prototype.hasOwnProperty.call(i,"response"))return i.response;if(!n)throw i.promise}const o={keys:t,equal:r.equal,promise:e(...t).then(e=>o.response=e).then(()=>{r.lifespan&&r.lifespan>0&&setTimeout(()=>{const e=qe.indexOf(o);-1!==e&&qe.splice(e,1)},r.lifespan)}).catch(e=>o.error=e)};if(qe.push(o),!n)throw o.promise}(e,t,!1,n),Ue=e.forwardRef(({anchorX:t="center",anchorY:n="middle",font:r,children:o,characters:i,onSync:a,...s},l)=>{const u=Ce(({invalidate:e})=>e),[f]=e.useState(()=>new S),[d,p]=e.useMemo(()=>{const t=[];let n="";return e.Children.forEach(o,e=>{"string"==typeof e||"number"==typeof e?n+=e:t.push(e)}),[t,n]},[o]);return Be(()=>new Promise(e=>k({font:r,characters:i},e)),["troika-text",r,i]),e.useLayoutEffect(()=>{f.sync(()=>{u(),a&&a(f)})}),e.useEffect(()=>()=>f.dispose(),[f]),e.createElement("primitive",c({object:f,ref:l,font:r,text:p,anchorX:t,anchorY:n},s),d)}),Ne=e.forwardRef(({makeDefault:t,camera:n,regress:r,domElement:o,enableDamping:i=!0,onChange:a,onStart:s,onEnd:l,...u},f)=>{const d=Ce(e=>e.invalidate),p=Ce(e=>e.camera),v=Ce(e=>e.gl),h=Ce(e=>e.events),m=Ce(e=>e.set),g=Ce(e=>e.get),b=Ce(e=>e.performance),y=n||p,w=o||h.connected||v.domElement,_=e.useMemo(()=>new O(y),[y]);return je(()=>{_.enabled&&_.update()}),e.useEffect(()=>(_.connect(w),()=>{_.dispose()}),[w,r,_,d]),e.useEffect(()=>{const e=e=>{d(),r&&b.regress(),a&&a(e)};return _.addEventListener("change",e),s&&_.addEventListener("start",s),l&&_.addEventListener("end",l),()=>{s&&_.removeEventListener("start",s),l&&_.removeEventListener("end",l),_.removeEventListener("change",e)}},[a,s,l]),e.useEffect(()=>{if(t){const e=g().controls;return m({controls:_}),()=>m({controls:e})}},[t,_]),e.createElement("primitive",c({ref:f,object:_,enableDamping:i},u))});export{He as C,Ne as O,Ue as T,Ce as a,je as u};
